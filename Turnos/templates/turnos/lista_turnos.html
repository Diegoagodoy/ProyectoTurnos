{% extends "turnos/base_turnos.html" %}

{% block title %}Turnos Médicos{% endblock %}

{% block turnos_content %}

<h2>Turnos Médicos</h2>

<form method="get" class="filtros-form">

    <label>
        Especialidad
        <select name="especialidad">
            <option value="">Todas</option>
            {% for e in especialidades %}
                <option value="{{ e.id }}"
                    {% if filtros.especialidad == e.id|stringformat:"s" %}selected{% endif %}>
                    {{ e.nombre }}
                </option>
            {% endfor %}
        </select>
    </label>

    <label>
        Médico
        <select name="medico">
            <option value="">Todos</option>
            {% for m in medicos %}
                <option value="{{ m.id }}"
                    {% if filtros.medico == m.id|stringformat:"s" %}selected{% endif %}>
                    {{ m }}
                </option>
            {% endfor %}
        </select>
    </label>

    <label>
        Paciente
        <select name="paciente">
            <option value="">Todos</option>
            {% for p in pacientes %}
                <option value="{{ p.id }}"
                    {% if filtros.paciente == p.id|stringformat:"s" %}selected{% endif %}>
                    {{ p }}
                </option>
            {% endfor %}
        </select>
    </label>

    <label>
        Fecha
        <input type="date" name="fecha" value="{{ filtros.fecha }}">
    </label>

    <label>
        Estado
        <select name="estado">
            <option value="">Todos</option>
            <option value="PENDIENTE" {% if filtros.estado == 'PENDIENTE' %}selected{% endif %}>Pendiente</option>
            <option value="CONFIRMADO" {% if filtros.estado == 'CONFIRMADO' %}selected{% endif %}>Confirmado</option>
            <option value="CANCELADO" {% if filtros.estado == 'CANCELADO' %}selected{% endif %}>Cancelado</option>
        </select>
    </label>

    <button type="submit" class="btn-primary">Buscar</button>
</form>

<table class="turnos-table">
    <thead>
        <tr>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Médico</th>
            <th>Paciente</th>
            <th>Estado</th>
        </tr>
    </thead>
    <tbody>
        {% for t in turnos %}
        <tr>
            <td>{{ t.fecha }}</td>
            <td>{{ t.hora }}</td>
            <td>{{ t.medico }}</td>
            <td>{{ t.paciente }}</td>
            <td>{{ t.estado }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5">No hay turnos para mostrar</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
